@inject HttpClient Http
@using MTG_Decks.Shared.Model;

<div class="filter-container">
    <div class="filter">
        <div class="filterRow">
            <a href="#"><img src="images/black.png" /></a>
            <a href="#"><img src="images/white.png" /></a>
            <a href="#"><img src="images/blue.png" /></a>
            <a href="#"><img src="images/green.png" /></a>
            <a href="#"><img src="images/red.png" /></a>
            <a href="#"><img src="images/colorLess.png" /></a>

            <div class="autocomplete-container">
                <input id="CardName" class="filterInput" value="@researchValue" @oninput="Research" />
                @if (autocompleteList.Count > 0)
                {
                    <ul class="suggest-container">
                        @foreach (var item in autocompleteList)
                        {
                            <li @onclick="() => Select(item)">@item</li>
                        }
                    </ul>
                }
            </div>

            <DropDown DropDownContent="test"></DropDown>
            @*<DropDown></DropDown>
        <DropDown></DropDown>*@
        </div>
        <div class="filterRow">
            @*<DropDown></DropDown>
                <DropDown></DropDown>
                <DropDown></DropDown>
                <DropDown></DropDown>
                <DropDown></DropDown>
                <DropDown></DropDown>
                <DropDown></DropDown>*@
        </div>
    </div>
</div>

@code {
    public List<string> autocompleteList = new List<string>();
    public string researchValue = "";
    public List<string> test = new List<string> { "zzz", "zzz" };

    public async Task Research(ChangeEventArgs e)
    {
        string url = $"https://api.scryfall.com/cards/autocomplete?q={e.Value}";
        AutocompleteResponse response = await Http.GetFromJsonAsync<AutocompleteResponse>(url);
        autocompleteList = response.Data;
    }

    public void Select(string e)
    {
        researchValue = e;
    }
}
